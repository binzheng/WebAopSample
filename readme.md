# WebAopSample

WebAopSampleは、AOP（Aspect-Oriented Programming、アスペクト指向プログラミング）を探求するためのサンプルプロジェクトです。このプロジェクトはASP.NET Core Web APIをベースにしており、クロスカッティングコンサーン（横断的関心事）の効率的な処理を目指します。ログやトランザクション管理などのアスペクトを、再利用可能で維持しやすい形で分離し、適用する方法を示しています。

## プロジェクト構成

プロジェクトは以下のコンポーネントから構成されています。

- **AopLibrary**: アスペクトを定義し適用するためのコアライブラリ。AOPの実装に必要な機能が含まれています。
  - **3階層DI実装**: ASP.NET Coreの組み込み依存性注入（DI）機能を利用して、各層の依存関係を自動的に解決し登録します。
  - **NLOG**: ログ管理にNLOGを採用。AOPを通じてのログ出力に対応しています。
  - **AOP機能**:
    1. メソッドの実行開始と終了時に自動的にログを出力
    2. Controller層での例外処理
    3. Repository層でのSQLクエリ実行時の自動ログ出力
- **WebAopSample**: ASP.NET Core Web APIプロジェクト。AopLibraryを利用してアスペクトを適用します。
  - **3階層構造**: Controller、Service、Repositoryの3層アーキテクチャが採用されています。
- **WebAppTestProject**: WebAopSampleのテストを行うプロジェクト。ユニットテストおよび統合テストを実施します。
  - Service層のコードを主なテスト対象とし、Repository層の呼び出しはMockを使用して代替します。


## 使用ライブラリ

以下の表は、プロジェクトで使用されているライブラリとその説明を示しています。

| ライブラリ                                  | 説明 |
|--------------------------------------------|------|
| Autofac                                    | ASP.NET Coreでの依存性注入を拡張し、AOP実装のための動的プロキシのサポートを提供するコンテナライブラリです。 |
| Castle.Core                                | 動的プロキシ生成とインターセプション機能を提供し、AOPサポートを強化します。 |
| Dapper                                     | 高速なデータベース操作を可能にする軽量ORMで、クエリのビルドと実行を効率化します。 |
| Microsoft.AspNetCore.Mvc.Abstractions      | ASP.NET CoreのMVCアプリケーション開発の基礎となるアブストラクションコンポーネントを提供します。 |
| Microsoft.Extensions.Hosting.Abstractions  | .NETアプリケーションのホスティングとライフサイクル管理を抽象化します。 |
| Microsoft.Extensions.Logging               | アプリケーションのロギング機能を構築および拡張するためのフレームワークを提供します。 |
| NLog                                       | 高度にカスタマイズ可能なロギングソリューションで、アプリケーションの監視とデバッグに役立ちます。 |


## 使用方法

1. プロジェクトをクローンし、ローカル環境に展開します。
2. Visual StudioなどのIDEでソリューションを開きます。
3. 各プロジェクトの依存関係を復元します。
4. `WebAopSample`プロジェクトを起動し、APIを実行します。

## アスペクトの適用例

このサンプルでは、AopLibraryを使用して以下のアスペクトが適用されています。

- メソッドの呼び出し前後にログを記録
- トランザクションの開始とコミット

これらのアスペクトは`WebAopSample`プロジェクト内で実施されます。



## 注意事項
このプロジェクトはサンプルであり、実稼働環境での使用を意図していません。セキュリティやパフォーマンスの観点から、実際のアプリケーションで使用する前に適切なテストと調整を行ってください。

これで、Markdownファイルとして保存すれば、GitHubや他のMarkdownレンダラーで綺麗に表示されるでしょう。





